###############################################################################
# registro.conf — Configuração do módulo de registro e log do sistema LFS Auto
# Local padrão: /mnt/lfs/libs/config/registro.conf
# Este arquivo é carregado automaticamente por lib/registro.sh
###############################################################################

### Diretórios e arquivos #####################################################

# Diretório principal de logs (será criado automaticamente se não existir)
LOG_DIR="/mnt/lfs/var/log/lfs"

# Nome base do arquivo de log (extensões .log e .json serão adicionadas)
LOG_FILE_BASE="lfs_build"

# Número máximo de logs antigos a manter antes da rotação
LOG_ROTATE_COUNT=10

# Compressão de logs antigos (requer gzip)
LOG_COMPRESS="yes"        # valores: yes | no

### Saída e exibição ##########################################################

# Modo silencioso (esconde log detalhado e mostra apenas etapas e status)
QUIET_MODE="no"           # valores: yes | no

# Exibir cores ANSI no terminal
USE_COLORS="yes"          # valores: yes | no

# Mostrar barra de progresso dinâmica
SHOW_PROGRESS="yes"       # valores: yes | no

# Atualização da barra de progresso (em segundos)
PROGRESS_UPDATE_INTERVAL=1

# Mostrar estatísticas de sistema (CPU, RAM, LOAD, DISK)
SHOW_SYSTEM_STATS="yes"   # valores: yes | no

### Formatação e detalhes #####################################################

# Formato de data/hora no log
LOG_DATE_FORMAT="%Y-%m-%d %H:%M:%S"

# Nível mínimo de log que será registrado no terminal
# (DEBUG, INFO, STEP, WARN, ERROR, FATAL)
LOG_LEVEL_SCREEN="STEP"

# Nível mínimo de log que será gravado no arquivo
LOG_LEVEL_FILE="DEBUG"

# Se "yes", o log também será salvo em formato JSON paralelo (para parsing externo)
JSON_LOG_ENABLE="yes"     # valores: yes | no

### Controle de erros #########################################################

# Sair imediatamente em qualquer erro fatal
EXIT_ON_FATAL="yes"

# Registrar stack trace em erros críticos
TRACE_ON_ERROR="yes"

### Paralelismo e sincronização ###############################################

# Permitir múltiplos workers simultâneos gravando log (com flock seguro)
ENABLE_PARALLEL_LOGGING="yes"

# Timeout máximo (em segundos) para obter lock de log
LOG_LOCK_TIMEOUT=5

### Recursos e performance ####################################################

# Coleta de CPU e memória (para rodapé)
STATS_SAMPLING_INTERVAL=2   # segundos entre amostras
STATS_AVG_WINDOW=5          # número de amostras usadas para média móvel

# Número máximo de threads de progresso simultâneas
MAX_PROGRESS_THREADS=4

### Segurança #################################################################

# Verificar espaço livre antes de iniciar (em MB)
MIN_DISK_SPACE_MB=512

# Falhar se log_dir estiver em partição montada como "noexec"
STRICT_FS_CHECK="yes"

### Personalização visual #####################################################

# Cores (ANSI)
COLOR_INFO="\e[1;36m"
COLOR_WARN="\e[1;33m"
COLOR_ERROR="\e[1;31m"
COLOR_FATAL="\e[1;41m"
COLOR_STEP="\e[1;32m"
COLOR_RESET="\e[0m"

# Barra de progresso visual
PROGRESS_CHAR_DONE="█"
PROGRESS_CHAR_TODO="░"
PROGRESS_WIDTH=40

###############################################################################
# Fim do registro.conf
# Recomenda-se não remover opções; apenas ajustar valores conforme necessário.
# Caso modifique caminhos, assegure que /mnt/lfs tem permissões e montagem seguras.
###############################################################################
